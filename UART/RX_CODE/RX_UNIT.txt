module RxUnit(
    input wire         reset_n,     
    input wire         data_tx,      
    input wire         clock,       
    input wire  [1:0]  parity_type,  
    input wire  [1:0]  baud_rate,    

    output             active_flag,
    output             done_flag,    
    output      [2:0]  error_flag,   
    output      [7:0]  data_out      
);

// Intermediate wires
wire baud_clk_w;              
wire [10:0] data_parallel_w; 
wire data_ready_w;            
wire parity_bit_w;          
wire start_bit_w;           
wire stop_bit_w;            

// Baud Generator Instance
BaudGenR BaudGen (
    .reset_n(reset_n),
    .system_clk(clock),
    .baud_rate(baud_rate),

    .baud_clk(baud_clk_w),
    .clock_stable() 
);

// SIPO Receiver Instance
SIPO_Receiver SIPO (
    .reset_active_low(reset_n),
    .serial_data_in(data_tx),
    .baud_clock(baud_clk_w),

    .is_active(active_flag),
    .data_ready(data_ready_w),
    .parallel_data_out(data_parallel_w)
);

// DeFramer Instance
DeFrame DeFramer (
    .frame_parallel(data_parallel_w),
    .frame_ready(data_ready_w),

    .extracted_parity(parity_bit_w),
    .extracted_start(start_bit_w),
    .extracted_stop(stop_bit_w),
    .frame_done(done_flag),
    .data_payload(data_out)
);

// Error Checking Instance
ErrorChecker ErrorCheck (
    .reset_active_low(reset_n),
    .frame_ready(done_flag),
    .received_frame({stop_bit_w, parity_bit_w, start_bit_w, data_out}),
    .received_parity(parity_bit_w),
    .received_start(start_bit_w),
    .received_stop(stop_bit_w),
    .parity_mode(parity_type),

    .error_location(), 
    .corrected(),      
    .corrected_data(), 
    .global_error_flag(), 
    .frame_error_flag(error_flag)
);

endmodule
